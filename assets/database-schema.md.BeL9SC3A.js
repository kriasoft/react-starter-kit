import{_ as n,C as l,c as h,o as i,a0 as a,b as p,w as t,a as d,G as r,a2 as k}from"./chunks/framework.CQUyrH_V.js";const b=JSON.parse('{"title":"Database Schema","description":"","frontmatter":{},"headers":[],"relativePath":"database-schema.md","filePath":"database-schema.md"}'),o={name:"database-schema.md"};function E(c,s,g,y,u,F){const e=l("Mermaid");return i(),h("div",null,[s[1]||(s[1]=a('<h1 id="database-schema" tabindex="-1">Database Schema <a class="header-anchor" href="#database-schema" aria-label="Permalink to &quot;Database Schema&quot;">​</a></h1><p>This document describes the database schema for your application. The schema provides a foundation for building multi-tenant SaaS applications with authentication, organizations, teams, and role-based access control.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The database uses:</p><ul><li><strong>Database Engine:</strong> Cloudflare D1 (SQLite) for edge computing compatibility</li><li><strong>ORM:</strong> Drizzle ORM for type-safe database operations</li><li><strong>Authentication:</strong> Built on <a href="https://www.better-auth.com/" target="_blank" rel="noreferrer">Better Auth</a> specification</li></ul><p>The schema is divided into two main sections:</p><ol><li><strong>Authentication tables</strong> - Required for user authentication and session management</li><li><strong>Application tables</strong> - For your specific business logic (organizations, teams, and your custom tables)</li></ol><div class="warning custom-block"><p class="custom-block-title">Important</p><p>The authentication tables follow <a href="https://www.better-auth.com/docs/concepts/database" target="_blank" rel="noreferrer">Better Auth&#39;s requirements</a>. Maintain compatibility when extending these tables.</p></div><h2 id="entity-relationship-diagram" tabindex="-1">Entity Relationship Diagram <a class="header-anchor" href="#entity-relationship-diagram" aria-label="Permalink to &quot;Entity Relationship Diagram&quot;">​</a></h2>',9)),(i(),p(k,null,{default:t(()=>[r(e,{id:"mermaid-52",class:"mermaid",graph:"erDiagram%0A%20%20%20%20%25%25%20Core%20Authentication%20Tables%0A%20%20%20%20user%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22User%20ID%20from%20identity%20provider%22%0A%20%20%20%20%20%20%20%20text%20name%20%22Full%20name%22%0A%20%20%20%20%20%20%20%20text%20email%20UK%20%22Email%20address%22%0A%20%20%20%20%20%20%20%20integer%20email_verified%20%22Email%20verification%20status%22%0A%20%20%20%20%20%20%20%20text%20image%20%22Profile%20image%20URL%22%0A%20%20%20%20%20%20%20%20integer%20is_anonymous%20%22Anonymous%20user%20flag%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Account%20creation%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20updated_at%20%22Last%20update%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20session%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Session%20ID%22%0A%20%20%20%20%20%20%20%20integer%20expires_at%20%22Session%20expiration%22%0A%20%20%20%20%20%20%20%20text%20token%20UK%20%22Session%20token%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20updated_at%20%22Last%20update%20timestamp%22%0A%20%20%20%20%20%20%20%20text%20ip_address%20%22Client%20IP%20address%22%0A%20%20%20%20%20%20%20%20text%20user_agent%20%22Client%20user%20agent%22%0A%20%20%20%20%20%20%20%20text%20user_id%20FK%20%22User%20reference%22%0A%20%20%20%20%20%20%20%20text%20active_organization_id%20%22Current%20organization%20context%22%0A%20%20%20%20%20%20%20%20text%20active_team_id%20%22Current%20team%20context%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20identity%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Identity%20record%20ID%22%0A%20%20%20%20%20%20%20%20text%20account_id%20%22Provider%20account%20ID%22%0A%20%20%20%20%20%20%20%20text%20provider_id%20%22OAuth%20provider%20name%22%0A%20%20%20%20%20%20%20%20text%20user_id%20FK%20%22User%20reference%22%0A%20%20%20%20%20%20%20%20text%20access_token%20%22OAuth%20access%20token%22%0A%20%20%20%20%20%20%20%20text%20refresh_token%20%22OAuth%20refresh%20token%22%0A%20%20%20%20%20%20%20%20text%20id_token%20%22OAuth%20ID%20token%22%0A%20%20%20%20%20%20%20%20integer%20access_token_expires_at%20%22Access%20token%20expiry%22%0A%20%20%20%20%20%20%20%20integer%20refresh_token_expires_at%20%22Refresh%20token%20expiry%22%0A%20%20%20%20%20%20%20%20text%20scope%20%22OAuth%20scopes%22%0A%20%20%20%20%20%20%20%20text%20password%20%22Hashed%20password%20for%20email%20auth%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20updated_at%20%22Last%20update%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20verification%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Verification%20ID%22%0A%20%20%20%20%20%20%20%20text%20identifier%20%22Email%20or%20other%20identifier%22%0A%20%20%20%20%20%20%20%20text%20value%20%22Verification%20code%2Ftoken%22%0A%20%20%20%20%20%20%20%20integer%20expires_at%20%22Expiration%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20updated_at%20%22Last%20update%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20%25%25%20Multi-tenancy%20Tables%0A%20%20%20%20organization%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Organization%20ID%22%0A%20%20%20%20%20%20%20%20text%20name%20%22Organization%20name%22%0A%20%20%20%20%20%20%20%20text%20slug%20UK%20%22URL-friendly%20identifier%22%0A%20%20%20%20%20%20%20%20text%20logo%20%22Logo%20URL%22%0A%20%20%20%20%20%20%20%20text%20metadata%20%22JSON%20metadata%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20member%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Membership%20ID%22%0A%20%20%20%20%20%20%20%20text%20user_id%20FK%20%22User%20reference%22%0A%20%20%20%20%20%20%20%20text%20organization_id%20FK%20%22Organization%20reference%22%0A%20%20%20%20%20%20%20%20text%20role%20%22Member%20role%20(owner%2C%20admin%2C%20member)%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Join%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20team%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Team%20ID%22%0A%20%20%20%20%20%20%20%20text%20name%20%22Team%20name%22%0A%20%20%20%20%20%20%20%20text%20organization_id%20FK%20%22Parent%20organization%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20updated_at%20%22Last%20update%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20team_member%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Team%20membership%20ID%22%0A%20%20%20%20%20%20%20%20text%20team_id%20FK%20%22Team%20reference%22%0A%20%20%20%20%20%20%20%20text%20user_id%20FK%20%22User%20reference%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Join%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20invitation%20%7B%0A%20%20%20%20%20%20%20%20text%20id%20PK%20%22Invitation%20ID%22%0A%20%20%20%20%20%20%20%20text%20email%20%22Invitee%20email%22%0A%20%20%20%20%20%20%20%20text%20inviter_id%20FK%20%22Inviting%20user%22%0A%20%20%20%20%20%20%20%20text%20organization_id%20FK%20%22Target%20organization%22%0A%20%20%20%20%20%20%20%20text%20role%20%22Invited%20role%22%0A%20%20%20%20%20%20%20%20text%20status%20%22Invitation%20status%22%0A%20%20%20%20%20%20%20%20text%20team_id%20FK%20%22Target%20team%20(optional)%22%0A%20%20%20%20%20%20%20%20integer%20expires_at%20%22Expiration%20timestamp%22%0A%20%20%20%20%20%20%20%20integer%20created_at%20%22Creation%20timestamp%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20%25%25%20Relationships%0A%20%20%20%20user%20%7C%7C--o%7B%20session%20%3A%20%22has%22%0A%20%20%20%20user%20%7C%7C--o%7B%20identity%20%3A%20%22authenticates%20with%22%0A%20%20%20%20user%20%7C%7C--o%7B%20member%20%3A%20%22belongs%20to%22%0A%20%20%20%20user%20%7C%7C--o%7B%20team_member%20%3A%20%22member%20of%22%0A%20%20%20%20user%20%7C%7C--o%7B%20invitation%20%3A%20%22invited%20by%22%0A%0A%20%20%20%20organization%20%7C%7C--o%7B%20member%20%3A%20%22has%20members%22%0A%20%20%20%20organization%20%7C%7C--o%7B%20team%20%3A%20%22contains%22%0A%20%20%20%20organization%20%7C%7C--o%7B%20invitation%20%3A%20%22receives%22%0A%0A%20%20%20%20team%20%7C%7C--o%7B%20team_member%20%3A%20%22has%20members%22%0A%20%20%20%20team%20%7C%7C--o%7B%20invitation%20%3A%20%22invites%20to%22%0A"})]),fallback:t(()=>s[0]||(s[0]=[d(" Loading... ",-1)])),_:1})),s[2]||(s[2]=a(`<h2 id="authentication-tables" tabindex="-1">Authentication Tables <a class="header-anchor" href="#authentication-tables" aria-label="Permalink to &quot;Authentication Tables&quot;">​</a></h2><p>These tables handle user authentication and are based on the Better Auth specification. They form the foundation of your application&#39;s security layer.</p><h3 id="core-tables" tabindex="-1">Core Tables <a class="header-anchor" href="#core-tables" aria-label="Permalink to &quot;Core Tables&quot;">​</a></h3><h4 id="user-table" tabindex="-1"><code>user</code> Table <a class="header-anchor" href="#user-table" aria-label="Permalink to &quot;\`user\` Table&quot;">​</a></h4><p>Central table for all user accounts in your application.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Primary key, typically a CUID or UUID</td><td>Yes</td></tr><tr><td><code>name</code></td><td>TEXT</td><td>User&#39;s display name</td><td>Yes</td></tr><tr><td><code>email</code></td><td>TEXT</td><td>Email address (unique)</td><td>Yes</td></tr><tr><td><code>email_verified</code></td><td>BOOLEAN</td><td>Email verification status</td><td>Yes</td></tr><tr><td><code>image</code></td><td>TEXT</td><td>Profile image URL</td><td>No</td></tr><tr><td><code>is_anonymous</code></td><td>BOOLEAN</td><td>Anonymous user flag</td><td>Yes</td></tr><tr><td><code>created_at</code></td><td>TIMESTAMP</td><td>Account creation time</td><td>Yes</td></tr><tr><td><code>updated_at</code></td><td>TIMESTAMP</td><td>Last modification time</td><td>Yes</td></tr></tbody></table><details class="details custom-block"><summary>TypeScript Schema Definition</summary><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sqliteTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">primaryKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  emailVerified: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email_verified&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;boolean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$defaultFn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  image: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  isAnonymous: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is_anonymous&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;boolean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  createdAt: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;created_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  updatedAt: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updated_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$onUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></details><h4 id="session-table" tabindex="-1"><code>session</code> Table <a class="header-anchor" href="#session-table" aria-label="Permalink to &quot;\`session\` Table&quot;">​</a></h4><p>Manages active user sessions with device tracking and organization context.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Session identifier</td><td>Yes</td></tr><tr><td><code>expires_at</code></td><td>TIMESTAMP</td><td>Session expiration time</td><td>Yes</td></tr><tr><td><code>token</code></td><td>TEXT</td><td>Unique session token</td><td>Yes</td></tr><tr><td><code>user_id</code></td><td>TEXT</td><td>Reference to user</td><td>Yes</td></tr><tr><td><code>ip_address</code></td><td>TEXT</td><td>Client IP for security</td><td>No</td></tr><tr><td><code>user_agent</code></td><td>TEXT</td><td>Browser/client info</td><td>No</td></tr><tr><td><code>active_organization_id</code></td><td>TEXT</td><td>Current org context</td><td>No</td></tr><tr><td><code>active_team_id</code></td><td>TEXT</td><td>Current team context</td><td>No</td></tr></tbody></table><h4 id="identity-table" tabindex="-1"><code>identity</code> Table <a class="header-anchor" href="#identity-table" aria-label="Permalink to &quot;\`identity\` Table&quot;">​</a></h4><p>Handles authentication credentials for both OAuth providers and email/password.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This table is named <code>identity</code> in our schema but maps to Better Auth&#39;s <code>account</code> table.</p></div><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Identity record ID</td><td>Yes</td></tr><tr><td><code>account_id</code></td><td>TEXT</td><td>Provider-specific account ID</td><td>Yes</td></tr><tr><td><code>provider_id</code></td><td>TEXT</td><td>Provider name (google, email, etc.)</td><td>Yes</td></tr><tr><td><code>user_id</code></td><td>TEXT</td><td>Reference to user</td><td>Yes</td></tr><tr><td><code>password</code></td><td>TEXT</td><td>Hashed password (email provider only)</td><td>No</td></tr><tr><td>OAuth token fields...</td><td>TEXT/TIMESTAMP</td><td>Various OAuth tokens and expiries</td><td>No</td></tr></tbody></table><h4 id="verification-table" tabindex="-1"><code>verification</code> Table <a class="header-anchor" href="#verification-table" aria-label="Permalink to &quot;\`verification\` Table&quot;">​</a></h4><p>Manages email verification, password resets, and other verification flows.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Verification ID</td><td>Yes</td></tr><tr><td><code>identifier</code></td><td>TEXT</td><td>Email or identifier to verify</td><td>Yes</td></tr><tr><td><code>value</code></td><td>TEXT</td><td>Verification code/token</td><td>Yes</td></tr><tr><td><code>expires_at</code></td><td>TIMESTAMP</td><td>Code expiration</td><td>Yes</td></tr></tbody></table><h2 id="application-tables" tabindex="-1">Application Tables <a class="header-anchor" href="#application-tables" aria-label="Permalink to &quot;Application Tables&quot;">​</a></h2><p>These tables implement the multi-tenant architecture with organizations and teams. They integrate with the authentication layer through Better Auth&#39;s <a href="https://www.better-auth.com/docs/plugins/organization" target="_blank" rel="noreferrer">organization</a> and <a href="https://www.better-auth.com/docs/plugins/teams" target="_blank" rel="noreferrer">teams</a> plugins.</p><h3 id="organization-table" tabindex="-1"><code>organization</code> Table <a class="header-anchor" href="#organization-table" aria-label="Permalink to &quot;\`organization\` Table&quot;">​</a></h3><p>Represents a tenant/company/workspace in your application. This is the primary grouping mechanism for multi-tenancy.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Organization ID</td></tr><tr><td><code>name</code></td><td>TEXT</td><td>Display name</td></tr><tr><td><code>slug</code></td><td>TEXT</td><td>URL-friendly identifier (unique)</td></tr><tr><td><code>logo</code></td><td>TEXT</td><td>Logo image URL</td></tr><tr><td><code>metadata</code></td><td>TEXT</td><td>JSON for custom fields</td></tr></tbody></table><h3 id="member-table" tabindex="-1"><code>member</code> Table <a class="header-anchor" href="#member-table" aria-label="Permalink to &quot;\`member\` Table&quot;">​</a></h3><p>Defines the relationship between users and organizations, including their role within each organization.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Membership ID</td></tr><tr><td><code>user_id</code></td><td>TEXT</td><td>Reference to user</td></tr><tr><td><code>organization_id</code></td><td>TEXT</td><td>Reference to organization</td></tr><tr><td><code>role</code></td><td>TEXT</td><td>Role (owner, admin, member)</td></tr></tbody></table><h3 id="team-table" tabindex="-1"><code>team</code> Table <a class="header-anchor" href="#team-table" aria-label="Permalink to &quot;\`team\` Table&quot;">​</a></h3><p>Optional subgroups within organizations. Use teams when you need more granular permissions beyond organization-level roles.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Team ID</td></tr><tr><td><code>name</code></td><td>TEXT</td><td>Team name</td></tr><tr><td><code>organization_id</code></td><td>TEXT</td><td>Parent organization</td></tr></tbody></table><h3 id="invitation-table" tabindex="-1"><code>invitation</code> Table <a class="header-anchor" href="#invitation-table" aria-label="Permalink to &quot;\`invitation\` Table&quot;">​</a></h3><p>Tracks pending invitations. Users can be invited to join organizations with specific roles, and optionally assigned to teams.</p><table tabindex="0"><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>TEXT</td><td>Invitation ID</td></tr><tr><td><code>email</code></td><td>TEXT</td><td>Invitee&#39;s email</td></tr><tr><td><code>inviter_id</code></td><td>TEXT</td><td>User who sent invitation</td></tr><tr><td><code>organization_id</code></td><td>TEXT</td><td>Target organization</td></tr><tr><td><code>role</code></td><td>TEXT</td><td>Invited role</td></tr><tr><td><code>status</code></td><td>TEXT</td><td>pending, accepted, expired</td></tr><tr><td><code>team_id</code></td><td>TEXT</td><td>Target team (optional)</td></tr><tr><td><code>expires_at</code></td><td>TIMESTAMP</td><td>Invitation expiry</td></tr></tbody></table><h2 id="extending-the-schema" tabindex="-1">Extending the Schema <a class="header-anchor" href="#extending-the-schema" aria-label="Permalink to &quot;Extending the Schema&quot;">​</a></h2><h3 id="adding-your-own-tables" tabindex="-1">Adding Your Own Tables <a class="header-anchor" href="#adding-your-own-tables" aria-label="Permalink to &quot;Adding Your Own Tables&quot;">​</a></h3><p>As you build your application, you&#39;ll add tables specific to your domain. Here&#39;s the recommended approach:</p><ol><li>Create a new schema file in <code>db/schema/</code> for each logical group:</li></ol><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// db/schema/product.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> product</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sqliteTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;product&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">primaryKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  description: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  price: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;price&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Store in cents</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  organizationId: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;organization_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> organization.id),</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  createdBy: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;created_by&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user.id),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  createdAt: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;created_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ol start="2"><li>Add relations for better querying:</li></ol><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> productRelations</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> relations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(product, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">one</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  organization: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">one</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(organization, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fields: [product.organizationId],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    references: [organization.id],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  creator: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">one</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fields: [product.createdBy],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    references: [user.id],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}));</span></span></code></pre></div><ol start="3"><li>Export from <code>db/schema/index.ts</code> and generate migrations</li></ol><h3 id="extending-existing-tables" tabindex="-1">Extending Existing Tables <a class="header-anchor" href="#extending-existing-tables" aria-label="Permalink to &quot;Extending Existing Tables&quot;">​</a></h3><p>To add fields to existing tables (like adding custom user fields):</p><ol><li>Update the schema file:</li></ol><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// db/schema/user.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sqliteTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... existing fields ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Your custom fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  phoneNumber: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;phone_number&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  preferences: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;preferences&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// JSON string</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tier: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;free&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ol start="2"><li>For authentication tables, update Better Auth configuration:</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>When adding fields to authentication tables, always update the Better Auth configuration to ensure proper data handling.</p></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">betterAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  user: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    additionalFields: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      phoneNumber: { type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      preferences: { type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      tier: { type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ol start="3"><li>Generate and apply migrations:</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add-custom-fields</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # or, bun --cwd db push</span></span></code></pre></div><details class="details custom-block"><summary>Important: Schema Compatibility</summary><p>When extending authentication tables, ensure your changes don&#39;t break Better Auth&#39;s expected schema. Always test authentication flows after making changes.</p></details><h3 id="role-based-access-control" tabindex="-1">Role-Based Access Control <a class="header-anchor" href="#role-based-access-control" aria-label="Permalink to &quot;Role-Based Access Control&quot;">​</a></h3><p>Implement RBAC using the member roles:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Check if user is organization admin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> membership</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.query.member.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findFirst</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(member.userId, userId),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(member.organizationId, orgId),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(member.role, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get all teams user belongs to</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> teams</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.query.teamMember.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(teamMember.userId, userId),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    team: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="common-query-patterns" tabindex="-1">Common Query Patterns <a class="header-anchor" href="#common-query-patterns" aria-label="Permalink to &quot;Common Query Patterns&quot;">​</a></h2><h3 id="multi-tenant-queries" tabindex="-1">Multi-tenant Queries <a class="header-anchor" href="#multi-tenant-queries" aria-label="Permalink to &quot;Multi-tenant Queries&quot;">​</a></h3><p>Always scope queries to the current organization:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get all products for the current organization</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> products</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.query.product.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(product.organizationId, session.activeOrganizationId),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    creator: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      columns: { id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="user-organization-access" tabindex="-1">User Organization Access <a class="header-anchor" href="#user-organization-access" aria-label="Permalink to &quot;User Organization Access&quot;">​</a></h3><p>Check user&#39;s access to resources:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Verify user has access to organization</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> membership</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.query.member.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findFirst</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(member.userId, userId), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(member.organizationId, orgId)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">membership) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Access denied&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="complex-relationships" tabindex="-1">Complex Relationships <a class="header-anchor" href="#complex-relationships" aria-label="Permalink to &quot;Complex Relationships&quot;">​</a></h3><p>Load nested relationships efficiently:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get organization with all members and their teams</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> org</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.query.organization.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findFirst</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(organization.id, orgId),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    members: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        user: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    teams: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        members: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          with: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            user: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h3><div class="danger custom-block"><p class="custom-block-title">Security Critical</p><ul><li><strong>Never expose sensitive tokens</strong>: Access tokens, refresh tokens, and passwords should never be sent to the client</li><li><strong>Validate organization context</strong>: Always verify user has access to the organization they&#39;re trying to access</li><li><strong>Use parameterized queries</strong>: Drizzle ORM handles this automatically</li><li><strong>Implement rate limiting</strong>: Especially for invitation endpoints</li></ul></div><h3 id="performance-tips" tabindex="-1">Performance Tips <a class="header-anchor" href="#performance-tips" aria-label="Permalink to &quot;Performance Tips&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">Optimization Guidelines</p><ul><li><strong>Index frequently queried fields</strong>: Email, slug, and foreign keys are already indexed</li><li><strong>Use relations for complex queries</strong>: Drizzle&#39;s <code>with</code> clause is more efficient than multiple queries</li><li><strong>Batch operations when possible</strong>: Use <code>db.insert().values([...])</code> for bulk inserts</li><li><strong>Limit data fetching</strong>: Only select columns you need using the <code>columns</code> option</li></ul></div><h3 id="design-patterns" tabindex="-1">Design Patterns <a class="header-anchor" href="#design-patterns" aria-label="Permalink to &quot;Design Patterns&quot;">​</a></h3><h4 id="multi-tenant-data-isolation" tabindex="-1">Multi-tenant Data Isolation <a class="header-anchor" href="#multi-tenant-data-isolation" aria-label="Permalink to &quot;Multi-tenant Data Isolation&quot;">​</a></h4><p>Every table that contains user data should reference an organization:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Always include organizationId in your tables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> yourTable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sqliteTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your_table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">primaryKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  organizationId: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;organization_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> organization.id),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... other fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Always filter by organization in queries</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yourTable.organizationId, currentOrgId);</span></span></code></pre></div><h4 id="soft-deletes" tabindex="-1">Soft Deletes <a class="header-anchor" href="#soft-deletes" aria-label="Permalink to &quot;Soft Deletes&quot;">​</a></h4><p>Preserve data integrity by marking records as deleted:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Add to your schema</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deletedAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;deleted_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Filter out deleted records</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(table.deletedAt),</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Soft delete</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yourTable)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ deletedAt: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yourTable.id, recordId));</span></span></code></pre></div><h4 id="audit-fields" tabindex="-1">Audit Fields <a class="header-anchor" href="#audit-fields" aria-label="Permalink to &quot;Audit Fields&quot;">​</a></h4><p>Track who created/updated records:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createdBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;created_by&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user.id),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updatedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updated_by&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user.id),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createdAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;created_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updatedAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updated_at&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$onUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()),</span></span></code></pre></div><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ol><li>Add your domain-specific tables in <code>db/schema/</code></li><li>Configure authentication providers in <code>api/lib/auth.ts</code></li><li>Set up database backups for production deployments</li><li>Implement proper access control in your API endpoints</li></ol><h2 id="additional-resources" tabindex="-1">Additional Resources <a class="header-anchor" href="#additional-resources" aria-label="Permalink to &quot;Additional Resources&quot;">​</a></h2><ul><li><a href="https://www.better-auth.com/docs" target="_blank" rel="noreferrer">Better Auth Documentation</a> - Authentication flows and plugins</li><li><a href="https://orm.drizzle.team/" target="_blank" rel="noreferrer">Drizzle ORM Documentation</a> - Database queries and migrations</li><li><a href="https://developers.cloudflare.com/d1/" target="_blank" rel="noreferrer">Cloudflare D1 Documentation</a> - Database deployment and optimization</li></ul>`,81))])}const C=n(o,[["render",E]]);export{b as __pageData,C as default};
